    \hypertarget{ux4ee5openmlux4e2dux7684ux6570ux636eux96c6csmux4e3aux4f8bux8ba1ux7b97ux8bc4ux5206ratingsux524d10ux7684ux7535ux5f71ux5230ux5e95ux6709ux591aux5c11ux4ebaux559cux6b22}{%
\subsubsection{以openml中的数据集CSM为例，计算评分Ratings前10的电影到底有多少人喜欢？}\label{ux4ee5openmlux4e2dux7684ux6570ux636eux96c6csmux4e3aux4f8bux8ba1ux7b97ux8bc4ux5206ratingsux524d10ux7684ux7535ux5f71ux5230ux5e95ux6709ux591aux5c11ux4ebaux559cux6b22}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入数据集获取工具}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}openml}
\PY{c+c1}{\PYZsh{} 导入数据分析库}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 获取数据}
\PY{n}{data} \PY{o}{=} \PY{n}{fetch\PYZus{}openml}\PY{p}{(}
    \PY{n}{data\PYZus{}id}\PY{o}{=}\PY{l+m+mi}{42371}\PY{p}{,}
    \PY{n}{as\PYZus{}frame}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
    \PY{n}{parser}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pandas}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{frame}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 查看数据集的前五行}
\PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   Year  Ratings  Genre      Gross       Budget  Screens  Sequel  Sentiment  \textbackslash{}
0  2014      6.3      8       9130    4000000.0     45.0       1          0
1  2014      7.1      1  192000000   50000000.0   3306.0       2          2
2  2014      6.2      1   30700000   28000000.0   2872.0       1          0
3  2014      6.3      1  106000000  110000000.0   3470.0       2          0
4  2014      4.7      8   17300000    3500000.0   2310.0       2          0

     Views  Likes  Dislikes  Comments  Aggregate.Followers
0  3280543   4632       425       636            1120000.0
1   583289   3465        61       186           12350000.0
2   304861    328        34        47             483000.0
3   452917   2429       132       590             568000.0
4  3145573  12163       610      1082            1923800.0
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 按照Rating降序排列，取出前10对应的Likes数}
\PY{n}{data}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ratings}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,} \PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ratings}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Likes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     Ratings  Likes
55       8.7  16635
166      8.6   4632
155      8.6  17541
174      8.3  13030
175      8.3  12607
158      8.2   1023
45       8.2   1390
212      8.2  18398
46       8.1   8567
129      8.1  11748
\end{Verbatim}
\end{tcolorbox}
